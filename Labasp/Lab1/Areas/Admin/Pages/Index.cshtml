@page
@model Lab1.Areas.Admin.Pages.IndexModel

<div class="container py-4">
    <h2 class="mb-4">Администрирование</h2>

    <ul class="nav nav-tabs" id="adminTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link @(Model.ActiveTab=="categories"?"active":"")" id="categories-tab" data-bs-toggle="tab" data-bs-target="#categories" type="button" role="tab">Категории</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link @(Model.ActiveTab=="sweets"?"active":"")" id="sweets-tab" data-bs-toggle="tab" data-bs-target="#sweets" type="button" role="tab">Сладости</button>
        </li>
    </ul>

    <div class="tab-content border border-top-0 p-3" id="adminTabsContent">
        <div class="tab-pane fade @(Model.ActiveTab=="categories"?"show active":"")" id="categories" role="tabpanel">
            <div class="d-flex justify-content-between align-items-center mb-2">
                <h5 class="m-0">Категории</h5>
                <form method="post" asp-page-handler="CreateCategory" class="d-flex gap-2">
                    <input type="text" name="Name" class="form-control" placeholder="Название" required />
                    <input type="text" name="NormalizedName" class="form-control" placeholder="Код (normalized)" />
                    <button class="btn btn-success"><i class="bi bi-plus-circle"></i> Добавить</button>
                </form>
            </div>
            <table class="table table-striped align-middle">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Название</th>
                        <th>Код</th>
                        <th class="text-end">Действия</th>
                    </tr>
                </thead>
                <tbody>
                @foreach (var c in Model.Categories)
                {
                    <tr>
                        <td>@c.Id</td>
                        <td>
                            <form method="post" asp-page-handler="UpdateCategory" class="row g-2">
                                <input type="hidden" name="Id" value="@c.Id" />
                                <div class="col-md-5">
                                    <input name="Name" value="@c.Name" class="form-control" />
                                </div>
                                <div class="col-md-5">
                                    <input name="NormalizedName" value="@c.NormalizedName" class="form-control" />
                                </div>
                                <div class="col-md-2 text-end">
                                    <button class="btn btn-primary"><i class="bi bi-save"></i></button>
                                    <button formaction="?handler=DeleteCategory" formmethod="post" name="id" value="@c.Id" class="btn btn-outline-danger"><i class="bi bi-trash"></i></button>
                                </div>
                            </form>
                        </td>
                        <td class="d-none">@c.NormalizedName</td>
                        <td class="text-end d-none"></td>
                    </tr>
                }
                </tbody>
            </table>
        </div>

        <div class="tab-pane fade @(Model.ActiveTab=="sweets"?"show active":"")" id="sweets" role="tabpanel">
            <div class="d-flex justify-content-between align-items-center mb-2">
                <h5 class="m-0">Сладости</h5>
                <form method="post" asp-page-handler="CreateSweet" class="row g-2 align-items-end">
                    <div class="col-md-2">
                        <input type="text" name="Name" class="form-control" placeholder="Название" required />
                    </div>
                    <div class="col-md-3">
                        <input type="text" name="Description" class="form-control" placeholder="Описание" />
                    </div>
                    <div class="col-md-2">
                        <input type="number" step="0.01" name="Price" class="form-control" placeholder="Цена" required />
                    </div>
                    <div class="col-md-3">
                        <select name="CategoryId" class="form-select">
                            @foreach (var c in Model.Categories)
                            {
                                <option value="@c.Id">@c.Name</option>
                            }
                        </select>
                    </div>
                    <div class="col-md-2 text-end">
                        <button class="btn btn-success"><i class="bi bi-plus-circle"></i> Добавить</button>
                    </div>
                </form>
            </div>

            <table class="table table-striped align-middle">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Название</th>
                        <th>Цена</th>
                        <th>Категория</th>
                        <th class="text-end">Действия</th>
                    </tr>
                </thead>
                <tbody>
                @foreach (var s in Model.Sweets)
                {
                    <tr>
                        <td>@s.Id</td>
                        <td>
                            <form method="post" asp-page-handler="UpdateSweet" class="row g-2">
                                <input type="hidden" name="Id" value="@s.Id" />
                                <div class="col-md-3">
                                    <input name="Name" value="@s.Name" class="form-control" />
                                </div>
                                <div class="col-md-3">
                                    <input name="Description" value="@s.Description" class="form-control" />
                                </div>
                                <div class="col-md-2">
                                    <input type="number" step="0.01" name="Price" value="@s.Price" class="form-control" />
                                </div>
                                <div class="col-md-3">
                                    <select name="CategoryId" class="form-select">
                                        @foreach (var c in Model.Categories)
                                        {
                                            <option value="@c.Id" selected="@(s.CategoryId==c.Id)">@c.Name</option>
                                        }
                                    </select>
                                </div>
                                <div class="col-md-1 text-end">
                                    <button class="btn btn-primary"><i class="bi bi-save"></i></button>
                                    <button formaction="?handler=DeleteSweet" formmethod="post" name="id" value="@s.Id" class="btn btn-outline-danger"><i class="bi bi-trash"></i></button>
                                </div>
                            </form>
                        </td>
                        <td class="d-none">@s.Price</td>
                        <td class="d-none">@s.Category?.Name</td>
                        <td class="text-end d-none"></td>
                    </tr>
                }
                </tbody>
            </table>
        </div>
    </div>
</div>


